#!name= All In One å¢å¼·åŠŸèƒ½
#!desc= ğŸ‰ æ­¤æ¨¡å¡Šä»¥å¢å¼·AppåŠŸèƒ½ç‚ºä¸»
#!system=ios

[MITM]
hostname = ios.prod.ftl.netflix.com, news-client.apple.com, news-client-search.apple.com, news-edge.apple.com, news-events.apple.com, gspe1-ssl.ls.apple.com, weather-data.apple.com, gspe35-ssl.ls.apple.com, -cdn*.smoot.apple.com, -fbs.smoot.apple.com, *.smoot.apple.com, *.smoot.apple.cn, uts-api.itunes.apple.com, trade-acs.m.taobao.com, spclient.wg.spotify.com, biz.caiyunapp.com, mobilead.kuwo.cn, rich.kuwo.cn, *.kwcdn.kuwo.cn, vip1.kuwo.cn, musicpay.kuwo.cn, api.bilibili.com, app.bilibili.com, api.live.bilibili.com, api.vc.bilibili.com, manga.bilibili.com, ap?.bilibili.com, app.biliintl.com, api.m.jd.com, ap?.bilibili.com, security.wechat.com, weixin110.qq.com, boxer.baidu.com

[URL Rewrite]
# ï£¿ Redirect Apple Maps to ğŸ‡¨ğŸ‡³CN
# åªä½œç”¨æ–¼Apple Mapsï¼Œä¸ä¿®æ”¹å®šä½æœå‹™å’Œåœ°å€æª¢æ¸¬ï¼Œå¯ä»¥é€šéæ­é…ä½¿ç”¨å…¶ä»–æ¨¡å¡Šé”æˆæ··åˆæ•ˆæœã€‚
(^https?:\/\/gspe\d*-ssl\.ls\.apple\.)(com|cn)(\/.*)(country_code=[A-Z]{2})(.*) $1$2$3country_code=CN$5 header
(^https?:\/\/gspe\d*-ssl\.ls\.apple\.)(com|cn)(\/.*)(environment=[a-z/-]{4,})(.*) $1$2$3environment=prod-cn$5 header

[Script]
# Apple
# é–‹æ©Ÿå¾Œæˆ–è€…é¦–æ¬¡ä½¿ç”¨ï¼Œéœ€è¦é€£æ¥Wi-Fiï¼Œç„¶å¾Œæ‰“é–‹é£›è¡Œæ¨¡å¼ï¼Œå†æ‰“é–‹åœ°åœ–ä¸€æ¬¡å³å¯ï¼Œå¦‚ç„¡æ•ˆéœ€é‡è¤‡ä¸€æ¬¡æ“ä½œï¼ä½†æ˜¯ï¼Œå¦‚æœä½ æˆåŠŸäº†ï¼Œä½†æŸäº›Appæˆ–ä½ ä¸å°å¿ƒå†æ¬¡æ‰“é–‹åœ°åœ–äº†ï¼Œé‚£éº¼ä½ ä¹Ÿéœ€è¦é‡è¤‡ä»¥ä¸Šæ“ä½œï¼
# ï£¿ Unlock Apple News ğŸ‡ºğŸ‡¸US
# è§£é–ğŸ‡ºğŸ‡¸USåœ°å€çš„ï£¿Newsï¼Œæ³¨ï¼šéœ€é…åˆåŸŸåé›†ä½¿ç”¨ï¼Œä½¿ç”¨éç¨‹ä¸­gateway.icloud.coméœ€èµ°ä»£ç†ç·šè·¯ã€‚
http-request ^https?:\/\/news-(edge|events)\.apple\.com\/(v1\/configs|analyticseventsv2\/async).* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_News.js, requires-body=true, tag=Apple_News
http-request ^https?:\/\/news-(client-search)\.apple\.com\/(v1\/search\?).* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_News.js, tag=Apple_News

# ï£¿ Response Geo Services to ğŸ‡­ğŸ‡°HK
# åªä½œç”¨æ–¼æª¢æ¸¬åœ°å€ï¼Œä¸ä¿®æ”¹Apple Mapså’ŒApple Newsï¼Œå¯ä»¥é€šéæ­é…ä½¿ç”¨å…¶ä»–æ¨¡å¡Šé”æˆæ··åˆæ•ˆæœã€‚
http-request ^https?:\/\/gspe\d*-ssl\.ls\.apple\.com(\/pep\/gcc) script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Geo_Services.js, argument=GeoCountryCode=HK, requires-body=false, tag=Geo_Services

# ï£¿ Replace Apple Weather with ğŸ‡ºğŸ‡¸US @waqi.info
# åˆ‡æ›ç©ºæ°£è³ªé‡æ•¸æ“šæºç‚ºwaqi.infoï¼Œä¸¦æ›´æ”¹æ¨™æº–ç‚ºAQI(US)
http-response ^https?:\/\/weather-data\.apple\.com\/(v1|v2)\/weather.*(?!dataSets=forecastNextHour)(include=.*air_quality.*|dataSets=.*airQuality.*).*(country=[A-Z]{2})?.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_Weather.js, requires-body=true, tag=Apple_Weather

# ï£¿ Enable Siri Suggestions
# åœ¨èšç„¦æœç´¢(Spotlight)å’ŒæŸ¥è©¢(Look Up)ä¸­å•“ç”¨Siriå»ºè­°(Siri Suggestions)åŠŸèƒ½ã€‚
# Bag (iOS/macOS)
http-request ^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/bag\?(.*) script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri_Suggestions.js, timeout=3, tag=Siri_Suggestions
# Spotlight & Look Up Search (iOS/macOS)
http-request ^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/search\?(.*) script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri_Suggestions.js, timeout=3, tag=Siri_Suggestions
# Siri Infomation Card (macOS)
http-request ^https?:\/\/api.*\.smoot\.apple\.(com|cn)\/card\?(.*) script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Siri_Suggestions.js, timeout=3, tag=Siri_Suggestions

# ï£¿ Enable Apple TV app
# è§£é–ï£¿TV appå…¨åŠŸèƒ½ï¼šä½¿ç”¨ğŸ‡ºğŸ‡¸USã€Œé«”è‚²ç¯€ç›®ã€å’Œã€Œå…’ç«¥ã€é é¢ï¼Œå„ªå…ˆç°¡é«”ä¸­æ–‡(zh-Hans)
# Enable All ï£¿TV app Tabs
http-response ^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/configurations\?.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, requires-body=true, timeout=3, tag=Apple_TV
# ï£¿TV app Tabs, Redirect Desktop Platform to AppleTV, Redirect Sports and Kids Tabs StoreFront to US (143441)
http-request ^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/canvases\/Roots\/(watchNow|tahoma_watchnow|movies|tv|sports|kids)\?.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# ï£¿TV app movies and shows and sports infomation Webs, Redirect Desktop Platform to AppleTV
http-request ^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/(movies|shows|sports|sporting-events).* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# ï£¿TV UpNext, Redirect Desktop Platform to AppleTV
http-request ^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/shelves\/uts.col.UpNext.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# ï£¿TV channels, Redirect StoreFront to US (143441)
http-request ^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/brands\?.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# ï£¿TV Live Playables, Redirect StoreFront to US (143441)
http-request ^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/playables.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# ï£¿TV Favorites Teams web, Redirect StoreFront to US (143441)
http-request ^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/favorites\?.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# ï£¿TV Watchlist Function, Redirect desktop Platform to iPad
http-request ^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/watchlist.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV
# Enable ï£¿TV Favorites Teams Function, Redirect StoreFront to US (143441)
http-request ^https?:\/\/uts-api\.itunes\.apple\.com\/uts\/(v1|v2|v3)\/favorites\/(add|remove).* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, requires-body=true, timeout=3, tag=Apple_TV
# ï£¿TV Product View, no Redirect
http-request ^https?:\/\/uts-api\.itunes\.apple\.com(\/uts\/)(v1|v2|v3)\/view\/product\/.* script-path=https://raw.githubusercontent.com/VirgilClyne/iRingo/main/js/Apple_TV.js, timeout=3, tag=Apple_TV

# Taobao App é¡¯ç¤ºæ­·å²åƒ¹æ ¼ by yichahucha
tb_price.js = type=http-request,requires-body=1,pattern=^http:\/\/.+\/amdc\/mobileDispatch,script-path=https://service.2ti.st/QuanX/Script/jd_tb_price/main.js
tb_price.js = type=http-response,requires-body=1,pattern=^https?:\/\/trade-acs\.m\.taobao\.com\/gw\/mtop\.taobao\.detail\.getdetail,script-path=https://service.2ti.st/QuanX/Script/jd_tb_price/main.js

# å¾®ä¿¡
å¾®ä¿¡å¤–éˆ = type=http-response,pattern=^https:\/\/weixin110\.qq\.com\/cgi-bin\/mmspamsupport-bin\/newredirectconfirmcgi,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/weixin-external-links.js,script-update-interval=0

è§£é™¤WeChatéˆæ¥é™åˆ¶ = type=http-response,pattern=^https\:\/\/(weixin110\.qq|security.wechat)\.com\/cgi-bin\/mmspamsupport-bin\/newredirectconfirmcgi\?,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/zZPiglet/Task/master/asset/UnblockURLinWeChat.js

è§£é™¤WeChatéˆæ¥é™åˆ¶ = type=http-response,pattern=^https\:\/\/(weixin110\.qq|security.wechat)\.com\/cgi-bin\/mmspamsupport-bin\/newredirectconfirmcgi\?,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/zZPiglet/Task/master/asset/UnblockURLinWeChat.js,argument=taobaoNotifyJump=false&useGoogleCache=true

è§£é™¤WeChatéˆæ¥é™åˆ¶ = type=http-response,pattern=^https:\/\/weixin110\.qq\.com\/cgi-bin\/mmspamsupport-bin\/newredirectconfirmcgi,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/weixin-external-links.js,script-update-interval=0

# å—¶å“©å—¶å“©, æ¸¯æ¾³å°ç•ªåŠ‡è‡ªå‹•åˆ‡æ›åœ°å€ & é¡¯ç¤ºè±†ç“£è©•åˆ†
Bili Region = type=http-response,pattern=^https:\/\/ap(p|i)\.bilibili\.com\/(pgc\/view\/(v\d\/)?app|x(\/v\d)?\/view\/video)\/(season|online)\?access_key,requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/specialmenfo/Surge/main/Bili_Auto_Regions.js,script-update-interval=0
# å¯é¸, é©ç”¨æ–¼æœç´¢æŒ‡å®šåœ°å€çš„ç•ªåŠ‡
# å¦‚éœ€æœç´¢æŒ‡å®šåœ°å€ç•ªåŠ‡, å¯åœ¨æœç´¢æ¡†æ·»åŠ å¾Œç¶´" æ¸¯", " å°", " ä¸­". ä¾‹å¦‚: é€²æ“Šçš„å·¨äºº æ¸¯(å¾Œé¢ç©ºæ ¼åŠ ä¸Šæ¸¯ã€å°ã€ä¸­ï¼‰
# å°ç£å‹•æ¼«éœ€è¦ä»¥ç¹é«”ä¸­æ–‡æœç´¢ å¦å‰‡æœä¸å‡ºä¾†
Bili Search = type=http-request,pattern=^https:\/\/app\.bilibili\.com\/x\/v\d\/search(\/type)?\?.+?%20(%E6%B8%AF|%E5%8F%B0|%E4%B8%AD)&,script-path=https://raw.githubusercontent.com/specialmenfo/Surge/main/Bili_Auto_Regions.js,requires-body=0,script-update-interval=0

# JD App é¡¯ç¤ºæ­·å²åƒ¹æ ¼ by yichahucha
jd_price.js = type=http-response,requires-body=1,pattern=^https?:\/\/api\.m\.jd\.com\/client\.action\?functionId=(wareBusiness|serverConfig|basicConfig),script-path=https://service.2ti.st/QuanX/Script/jd_tb_price/main.js

# Netflixè©•åˆ†
http-request ^https?://ios\.prod\.ftl\.netflix\.com/iosui/user/.+path=%5B%22videos%22%2C%\d+%22%2C%22summary%22%5D script-path=https://kinta.ma/surge/scripts/netflix_rating.js

http-response ^https?://ios\.prod\.ftl\.netflix\.com/iosui/user/.+path=%5B%22videos%22%2C%\d+%22%2C%22summary%22%5D requires-body=1,script-path=https://kinta.ma/surge/scripts/netflix_rating.js

# Spotify Premium
spotify-proto = type=http-response,pattern=^https:\/\/spclient\.wg\.spotify\.com\/(bootstrap\/v1\/bootstrap|user-customization-service\/v1\/customize)$,requires-body=1,binary-body-mode=1,max-size=0,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/spotify-proto.js,script-update-interval=0

# å½©é›²å¤©æ°£_SVIP
å½©é›²å¤©æ°£_SVIP = type=http-response,requires-body=1,max-size=0,pattern=https?:\/\/biz\.caiyunapp\.com\/(membership_rights|v2\/user),script-path=https://raw.githubusercontent.com/nxyd/Surge/main/caiyun_svip.js

# é…·æˆ‘VIP
é…·æˆ‘vipè§£é– = type=http-response,pattern=^https?:\/\/vip1\.kuwo\.cn\/(vip\/v2\/user\/vip|vip\/spi/mservice),requires-body=1,max-size=0,script-path=https://raw.githubusercontent.com/NobyDa/Script/master/Su

# å—¶å“©å—¶å“©ç•ªåŠ‡é–‹å•“1080P+
å—¶å“©å—¶å“©ç•ªåŠ‡é–‹å•“1080P+ = type=http-response,pattern=^https:\/\/ap(p|i)\.bilibili\.com\/((pgc\/player\/api\/playurl)|(x\/v2\/account\/myinfo\?)|(x\/v2\/account/mine\?)),requires-body=1,max-size=0,timeout=10,script-path=https://raw.githubusercontent.com/zqzess/rule_for_quantumultX/master/js/backup/bilifj.js,script-update-interval=0


# blackmatrix7
BiliBili_æ¨è–¦å»å»£å‘Š = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/app\.bilibili\.com\/x\/v2\/feed\/index,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
BiliBili_è¿½ç•ªå»å»£å‘Š = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/api\.bilibili\.com\/pgc\/page\/bangumi,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
BiliBili_ç›´æ’­å»å»£å‘Š = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/api\.live\.bilibili\.com\/xlive\/app-room\/v1\/index\/getInfoByRoom,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
BiliBili_å‹•æ…‹å»å»£å‘Š = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/api\.vc\.bilibili\.com\/dynamic_svr\/v1\/dynamic_svr\/dynamic_(history|new)\?,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
BiliBili_é–‹å±å»å»£å‘Š = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/app\.bilibili\.com\/x\/v2\/splash\/list,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
BiliBili_æ¨™ç±¤é è™•ç† = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/app\.bilibili\.com\/x\/resource\/show\/tab,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js
BiliBili_æˆ‘çš„é é¢è™•ç† = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/app\.bilibili\.com\/x\/v2\/account\/mine,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/bilibili/bilibili_plus.js

# ç™¾åº¦é˜²è·³è½‰App Store
ç™¾åº¦é˜²è·³è½‰ = type=http-response,pattern=^https:\/\/boxer\.baidu\.com\/scheme\?scheme,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/baidu-no-redirect.js

